(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[743],{5348:function(e,r,n){"use strict";n(7294);var t=n(8375),i=n(5893);r.Z=function(e){return(0,i.jsx)(t.Z,{variant:e.varient,children:e.children})}},4268:function(e,r,n){"use strict";n.r(r),n.d(r,{__N_SSP:function(){return $},default:function(){return q}});var t=n(7294),i=n(9008),s=n(2185),c=n(29),o=n(6835),d=n(7794),a=n.n(d),l=n(682),u=n(1608),h=n(1555),f=n(8695),p=n(1330),x=n(8182),v=n(5005),j=n(1664),m=n.n(j),Z=n(381),w=n.n(Z),y=n(1163),g=n(5348),S="https://js.stripe.com/v3",b=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,_="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",I=null,k=function(e){return null!==I||(I=new Promise((function(r,n){if("undefined"!==typeof window)if(window.Stripe&&e&&console.warn(_),window.Stripe)r(window.Stripe);else try{var t=function(){for(var e=document.querySelectorAll('script[src^="'.concat(S,'"]')),r=0;r<e.length;r++){var n=e[r];if(b.test(n.src))return n}return null}();t&&e?console.warn(_):t||(t=function(e){var r=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(S).concat(r);var t=document.head||document.body;if(!t)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return t.appendChild(n),n}(e)),t.addEventListener("load",(function(){window.Stripe?r(window.Stripe):n(new Error("Stripe.js not available"))})),t.addEventListener("error",(function(){n(new Error("Failed to load Stripe.js"))}))}catch(i){return void n(i)}else r(null)}))),I},E=function(e,r,n){if(null===e)return null;var t=e.apply(void 0,r);return function(e,r){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"1.27.0",startTime:r})}(t,n),t},P=Promise.resolve().then((function(){return k(null)})),A=!1;P.catch((function(e){A||console.warn(e)}));var D,O=function(){return D||(D=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];A=!0;var t=Date.now();return P.then((function(e){return E(e,r,t)}))}("pk_test_51KD67rSEMve4LTTE3FecGBULj5GSvl7UcnqtMjk21K5dxVR81b5GOq7o1RKcF347RmpoAvybZUSeYrpseYT6G1fN00Jwhh3r9W")),D};function C(e,r){return M.apply(this,arguments)}function M(){return(M=(0,c.Z)(a().mark((function e(r,n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(r,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(n||{})});case 3:return t=e.sent,e.next=6,t.json();case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(0),new Error(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}var T=n(8892),N=n(3139),Y=n(5893),F=function(e){var r,n,i,d,j=e.user,Z=e.token,S=(0,s.I0)(),b=((0,y.useRouter)(),(0,t.useState)(!1)),_=(b[0],b[1]),I=(0,T.lM)(),k=(0,o.Z)(I,2),E=k[0],P=k[1],A=P.isLoading,D=P.isSuccess,M=(0,s.v9)((function(e){return e.order})).currentOrder,F=function(){var e=(0,c.Z)(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null!==j&&void 0!==j&&j.isAdmin&&Z&&M&&M._id)||M.isDelivered){e.next=5;break}return e.next=3,E({orderId:M._id,token:Z});case 3:"data"in(r=e.sent)&&S((0,N.wC)(r.data));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=(0,c.Z)(a().mark((function e(r){var n,t,i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),!M){e.next=15;break}return _(!0),e.next=5,C("/api/checkout_sessions",{order:M});case 5:return n=e.sent,e.next=8,O();case 8:return t=e.sent,e.next=11,t.redirectToCheckout({sessionId:n.id});case 11:i=e.sent,s=i.error,console.warn(s.message),_(!1);case 15:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return(0,Y.jsx)(l.Z,{children:(0,Y.jsx)(Y.Fragment,{children:M&&j&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsxs)("h1",{children:["Order ",null===M||void 0===M?void 0:M._id]}),(0,Y.jsxs)(u.Z,{children:[(0,Y.jsx)(h.Z,{md:8,children:(0,Y.jsxs)(f.Z,{variant:"flush",children:[(0,Y.jsxs)(f.Z.Item,{children:[(0,Y.jsx)("h2",{children:"Shipping"}),(0,Y.jsxs)("p",{children:[(0,Y.jsx)("strong",{children:"Name :"})," ",j.name]}),(0,Y.jsxs)("p",{children:[(0,Y.jsx)("strong",{children:"Email :"})," ",(0,Y.jsx)(m(),{href:"mailto:".concat(j.email),passHref:!0,children:(0,Y.jsx)("a",{children:j.email})})]}),(0,Y.jsxs)("p",{children:[(0,Y.jsx)("strong",{children:"Address : "}),null===(r=M.shippingAddress)||void 0===r?void 0:r.address,","," ",null===(n=M.shippingAddress)||void 0===n?void 0:n.city," ",null===(i=M.shippingAddress)||void 0===i?void 0:i.postalCode,","," ",null===(d=M.shippingAddress)||void 0===d?void 0:d.country]}),M.isDelivered?(0,Y.jsxs)(g.Z,{varient:"success",children:["Delivered On"," ",w()(M.deliveredAt).format("DD/MM/YYYY")]}):(0,Y.jsx)(g.Z,{varient:"danger",children:"Not Delivered"})]}),(0,Y.jsxs)(f.Z.Item,{children:[(0,Y.jsx)("h2",{children:"Payment Method"}),(0,Y.jsxs)("p",{children:[(0,Y.jsx)("strong",{children:"Method : "}),M.paymentMethod]}),M.isPaid?(0,Y.jsxs)(g.Z,{varient:"success",children:["Paid on ",w()(M.paidAt).format("DD/MM/YYYY")]}):(0,Y.jsx)(g.Z,{varient:"danger",children:"Not Paid"})]}),(0,Y.jsxs)(f.Z.Item,{children:[(0,Y.jsx)("h2",{children:"Order Items"}),M&&0===(null===M||void 0===M?void 0:M.orderItems.length)?(0,Y.jsx)(g.Z,{children:"Your Cart is Empty"}):(0,Y.jsx)(f.Z,{variant:"flush",children:M.orderItems.map((function(e,r){return(0,Y.jsx)(f.Z.Item,{children:(0,Y.jsxs)(u.Z,{children:[(0,Y.jsx)(h.Z,{md:1,children:(0,Y.jsx)(p.Z,{src:"".concat("http://localhost:5000").concat(e.image),alt:e.name,fluid:!0,rounded:!0})}),(0,Y.jsx)(h.Z,{children:(0,Y.jsx)(m(),{href:"/product/".concat(e.productId),children:e.name})}),(0,Y.jsxs)(h.Z,{md:4,children:[e.qty," x $",e.price," = $",e.qty*e.price]})]})},r)}))})]})]})}),(0,Y.jsx)(h.Z,{md:4,children:(0,Y.jsx)(x.Z,{children:(0,Y.jsxs)(f.Z,{variant:"flush",children:[(0,Y.jsx)(f.Z.Item,{children:(0,Y.jsx)("h2",{children:"Order Summary"})}),(0,Y.jsx)(f.Z.Item,{children:(0,Y.jsxs)(u.Z,{children:[(0,Y.jsx)(h.Z,{children:"Items"}),(0,Y.jsxs)(h.Z,{children:["$",M.itemsPrice]})]})}),(0,Y.jsx)(f.Z.Item,{children:(0,Y.jsxs)(u.Z,{children:[(0,Y.jsx)(h.Z,{children:"Shipping"}),(0,Y.jsxs)(h.Z,{children:["$",M.shippingPrice]})]})}),(0,Y.jsx)(f.Z.Item,{children:(0,Y.jsxs)(u.Z,{children:[(0,Y.jsx)(h.Z,{children:"Tax"}),(0,Y.jsxs)(h.Z,{children:["$",M.taxPrice]})]})}),(0,Y.jsx)(f.Z.Item,{children:(0,Y.jsxs)(u.Z,{children:[(0,Y.jsx)(h.Z,{children:"Total"}),(0,Y.jsxs)(h.Z,{children:["$",M.totalPrice]})]})}),!M.isPaid&&(0,Y.jsx)(f.Z.Item,{children:(0,Y.jsx)(v.Z,{target:"_blank",style:{width:"100%"},type:"submit",onClick:$,children:"Pay"})}),(null===j||void 0===j?void 0:j.isAdmin)&&M.isPaid&&!M.isDelivered&&(0,Y.jsx)(f.Z.Item,{children:(0,Y.jsx)(v.Z,{style:{width:"100%"},onClick:function(){F()},children:A||D?"Delivered":"Mark as Deliver"})})]})})})]})]})})})},$=!0,q=function(e){var r=e.order,n=e.user,c=e.token,o=(0,s.I0)();return(0,t.useEffect)((function(){o((0,N.wC)(r))}),[]),(0,Y.jsx)(t.Fragment,{children:(0,Y.jsxs)("div",{children:[(0,Y.jsx)(i.default,{children:(0,Y.jsx)("title",{children:"Stonkify | Order Details"})}),r&&n&&(0,Y.jsx)(F,{order:r,user:n,token:c})]})})}},2854:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/orders/[...id]",function(){return n(4268)}])},2587:function(e,r,n){"use strict";function t(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}n.d(r,{Z:function(){return t}})},6835:function(e,r,n){"use strict";n.d(r,{Z:function(){return i}});var t=n(2937);function i(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,i,s=[],c=!0,o=!1;try{for(n=n.call(e);!(c=(t=n.next()).done)&&(s.push(t.value),!r||s.length!==r);c=!0);}catch(d){o=!0,i=d}finally{try{c||null==n.return||n.return()}finally{if(o)throw i}}return s}}(e,r)||(0,t.Z)(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},2937:function(e,r,n){"use strict";n.d(r,{Z:function(){return i}});var t=n(2587);function i(e,r){if(e){if("string"===typeof e)return(0,t.Z)(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,t.Z)(e,r):void 0}}}},function(e){e.O(0,[885,969,774,888,179],(function(){return r=2854,e(e.s=r);var r}));var r=e.O();_N_E=r}]);